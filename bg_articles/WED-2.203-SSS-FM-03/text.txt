 ВЪВЕДЕНИЕ Методите Монте Карло са широк клас от изчислителни алгоритми, които се прилагат за намиране на решение на посочен проблем, който има множество зададени входни данни. Ранният вариант на метода може да бъде видян в експеримента „Иглата на Буфон“, проведен още през XVIII в. Той представлява предположение за под, направен от паралелни и равни по ширина дървени дъски, като чрез Методи Монте Карло се изчислява каква е вероятността, ако бъде изпусната игла на пода, тя да попадне така, че да пресича разстоянието между две дъски [3].  Модерната  версия  на  Марковата  верига  на  Методи  Монте  Карло  е  изработена  от Станислав  Улам  през  40-те  години  на  XX  в.  Той  работил  по  проекти  в  националната лаборатория  „Лос  Аламос“.  Научавайки  за  работата  му,  Джон  фон  Нойман  създава електронноизчислителна машина (ENIAC), чрез която прилага изчисленията на Методите Монте Карло. Името Методи Монте Карло произлиза от съвместната работа на фон Нойман и Улам, която изисквала кодово име. Тогава техен колега, Николай Метрополис, предложил името Монте Карло, на името на казиното Монте Карло в Монако, където чичото на Улам взема пари назаем от роднини, за да залага [2].  Методите Монте Карло също така са били много важни за проекта „Манхатън“ (проект за създаване на първите ядрени оръжия, осъществен в САЩ между 1939 и 1946г.) [3].  ИЗЛОЖЕНИЕ Структурата на Методи Монте Карло зависи единствено от началната стойност S  на 0цената на разглеждания актив, т.е. цената S в началния момент t , от който започва опцията. 0Методът на Монте Карло симулира случайното движение на цените на финансовите активи и използва за оценяването на опциите логически твърдения и понятия от вероятностите и статистиката  като  централна  гранична  теорема,  математическо  очакване,  доверителни интервали и др. [1].  Като начало се симулират голям брой ценови пътеки, описващи случайното движение на дадения  ценови  процес  S  в  интервала  [0,  T].  Пресмята  се  функцията  на  печалба  и t                                                 3 Докладът е представен на студентската научна сесия на 23. 05. 2018 г. в секция „Финансова математика“ с оригинално заглавие на български език: МЕТОДИ МОНТЕ КАРЛО И ПРИЛОЖЕНИЯ.   - 22 - PROCEEDINGS OF UNIVERSITY OF RUSE - 2018, volume 57, book 6.5. математическото очакване за всяка от примерните ценови пътеки, след което се пресмята премиумът на дадената опция чрез дисконтиране и намирането на доверителен интервал за средната стойност от всички симулирани ценови пътеки. При оценяване на Европейски опции е нужно да се намери математическото очакване на функцията на печалба само в датата на падежа T. Полученият резултат в момент T трябва да се дисконтира с множител e-rT, за да получим премиума на дадената опция в настоящия момент t=0, т.е: VS ,0erTEˆ VS ,T.                    (1) 0 TdSЗа да приложим метода Монте Карло към модела на Блек-Шолс   rdt dW  за S tпресмятане на премиума на Европейска кол опция, пресмятаме функцията на печалба:  r12Te T VS,T: maxS e 2  ,0,                   (2) 0  където К е страйкова цена, S  – цена на разглеждания актив, лихва r и волатилност са 0 предварително определени от банката и фиксирани през целия живот на опциятаt 0,T .  Премиумите на опцията V(S , 0) за всяка ценова пътека, получена по горната формула, Tсе получават чрез дисконтиране на функцията на печалба с множителя e-rT: VS ,0:erTmaxS er122Te T,0.                 (3) 0  0    За завършване на прилагането на метода Монте Карло се пресмята доверителен интервал за стойностите на премиумите на опцията.  За да бъде постигнато необходимото ниво на точност се използват голям брой ценови пътеки. Ако искаме да увеличим точността с една десета е нужно да увеличим стократно броя на генерираните ценови пътеки.  Евристичната структура на метода Монте Карло е основно негово предимство, тъй като при него могат лесно да се симулират ценови пътеки на нестандартни деривати. Пример за нестандартни  деривати  са  бариерните  опции,  които  са  много  популярни  деривати  на финансовите пазари. Съществуват две основни причини за търгуването на голямо количество бариерни опции на борсовите пазари:  1.  имат по-ниски премиуми от съответните ванилови опции 2.  компенсациите, които се изплащат в случай, че опцията се анулира, т.е. цената на разглеждания актив е достигнала предварително определена бариера преди датата на падеж [1]. Симулацията на случайни числа често е единственият начин да се опише и генерира вероятностното разпределение S на разглеждания актив.  tГолемината на времевите стъпки се избира така, че ценовите пътеки да стимулират реалистично стохастичния процес S в интервала 0t T. За тази цел се минава през следните tдве неща: 1.  Времето  0t T до падежа T на дадена опция се дискретизира чрез избиране на подходяща времева стъпка  t,играеща роля на времевия интервал t  във формула 1  Stt  St expr 22t t, където j 1,..., Nиt0  Nt T; 2.  Генериране на ценови пътеки  S, всяка от  които  бива генерирана поотделно чрез tпоследователни  стойности  S ,...,S ,...,S , j 1,...,N,t 0иt Nt T от t t jt T 0 00 0 1  формула S  S expr 2t t. tt t  2    - 23 - PROCEEDINGS OF UNIVERSITY OF RUSE - 2018, volume 57, book 6.5. Цената на разглеждания актив в модела на Блек-Шолс S има логнормално разпределение t(log-normal distribution) за разлика от модела на Мертон, където цената на разглеждания актив NtS  следва  процес  на  Леви  L dtW Y,който  е  с  по-сложно  разпределение:t t t tt1 Nt  1   1  St  S0expdtWt Yi , където р 22 exp 221 от познатото в i1 1  икономиката логнормално от формула Stt St expr 22t t.  Пример 1. Нека симулираме 30 ценови пътеки, като цената на разглеждания актив в началния момент е S 35и се описва от случаен процес, следващ Брауново лутане. За симулациите са 0използвани следните параметри:NRepl 30е броят на симулираните пътеки, безрисковият лихвен процент е r 0,07и волатилността е 0,1 за период от една година, т.е. T 2 (този период може да се разглежда като падеж за даден вид опция). Общият брой на междинните времеви моменти използвани за симулацията на ценовите пътеки е 100, т.е. имаме 50 стъпки по времето и съответно параметър NSteps100. Цената на дадения актив за малък период от време не се изменя рязко. Това е основно отличително свойство на Брауновото лутане. Чрез тази програма са генерирани ценови пътеки, които  може  да  видите  на  фигурата  по-долу.  Графиките  потвърждават  две  основни отличителни характеристики на ценовите пътеки, следващи Брауново лутане в модела на Блек-Шолс: 1.  непрекъснати промени (continuous changes) на стойността на ценовата пътека, т.е. цената на разглеждания актив има повишение или намаляване във всеки един момент 2.  малки изменения в цената на разглеждания актив за кратък период от време, т.е. цените не могат да се променят рязко. Много е малка вероятността да се случат големим промени в цената, което изключва появата на скокове [1].   Програма 1 %Симулация на ценови пътеки в модела на Блек-Шолс % function SPaths = % Pr1(S0, r, sigma, T, NSteps, NRepl) NRepl = 30; % брой ценови пътеки NSteps = 100; % брой времеви стъпки T = 2; % матуритет S0 = 35; % начална цена на актива r = 0.07; % безрисков лихвен процент sigma = 0.1; % параметър на волатилност dt=T/NSteps; % дължина на времевите стъпки % Формула (3.3) за симулация на ценови пътеки:  1  % Stt  St expr 22t  t, където t:dt,  ̴N(0,1).  2 nudt=(r-0.5*sigma^2)*dt; % nudt:r  dt   2 sidt=sigma*sqrt(dt); % sidt: dt  % Генериране на ценови пътеки като стойностите им % се запазват в матрица с размерност [NRepl × NSteps], % NRepl е броят на ценовите пътеки на   - 24 - PROCEEDINGS OF UNIVERSITY OF RUSE - 2018, volume 57, book 6.5. % NSteps e броят на еднаквите времеви стъпки Increments = nudt+sidt*randn(NRepl,NSteps); LogPaths = cumsum([log(S0)*ones(NRepl,1),Increments],2); % Ценови пътеки в нова матрица Spaths SPaths = exp(LogPaths);  % Цикъл за генериране на последователни времеви t  j % стъпки: t ,t ,,t ,t 0,t dt,t 2dt,,t  NSteps dt 1 2 NSteps1 1 2 3 NSteps1for j = 1:NSteps+1  t(j) = (j-1)*dt; % в програмата t j :t  jend % Генериране на фигура с ценовите пътеки SPaths plot(t, SPaths) % Етикети за заглавие и оси на генерираната фигура title('Симулация  на  ценови  пътеки  в  модела  на  Блeк-Шолс','FontSize',12) xlabel('Време t до падежа T, T=2') ylabel('30 ценови пътеки генерирани от S_{0}=35')   Фиг. 1. Симулация на ценови пътеки, моделирани чрез случаен процес: Брауново лутане в Модела на Блек-Шолс  Пример 2. Нека симулираме ценови пътеки, като движението на цената на разглеждания актив се описва от процес на Леви, използван в модела на Мертон.  За да можем да направим сравнение с модела на Блек-Шолс, ще използваме същите параметри от програма 1, т.е. безрисков лихвен процент  r = 0,07 и волатилност 0,1за период две години T 2 (този период може да се разглежда като падеж за даден вид опция), а броят на симулираните ценови пътеки е 30 и цената на разглеждания актив в началния моментS 35. Примерът е изследван чрез програма 2. 0 Програма 2 % Симулация на ценови пътеки в модела на Мертон N = 100; % брой времеви стъпки M = 30; % брой ценови пътеки T = 2; % матуритет price = 35; % начална цена на актива strike = 35; % страйкова цена rate = 0.07; % лихва   - 25 - PROCEEDINGS OF UNIVERSITY OF RUSE - 2018, volume 57, book 6.5. sigma = 0.1; % волатилност div = 0; % дивидент lambda = 5; % параметър за интензитета нa скоковете % Теоретични формули за разпределенията % log(1+k) ~ N(Gamma1,Delta^2) % Gamma1 = Gamma-0.5*Delta^2, % E(k) = kappa = exp(Gamma) – 1 Gamma = 0; Delta = 0.3; Gamma1 = Gamma - 0.5*Delta^2; kappa = exp(Gamma) - 1; dt = T/N; % времева стъпка for i = 1:N+1 t(i) = (i-1)*dt; end sum = 0; % Нулева стойност за сумиране на печалби for i = 1 : M % Начална цена на актива за всяка симулация S(1,i) = price; for j = 2:N+1 % Генериране на случайните числа чрез % стандартно Нормално разпределение deviate = normrnd(0,1); % Генериране на случайни числа чрез Поасоново % разпределение temp = poissrnd(lambda*dt); TJS = 0; for k = 1:temp JS = normrnd(Gamma1,Delta); TJS = TJS + JS; end % Генериране на ценовите пътеки S(j,i) S(j,i)  =  S(j-1,i)*exp((rate-div-lambda*kappa-0.5*sigma^2)*dt+sigma*sqrt(dt)*deviate+TJS); end payoff = max(S(N+1,i)-strike, 0); % чиста печалба sum = sum + payoff; % сумиране на печалбите end % Цена на ванилова Европейска кол опция метода на % Монте Карло, като се дисконтира очакваната цена Euro_Call_Value = exp(-rate*T)*(sum/M) % Генериране на фигура с ценовите пътеки SPaths plot(t, S) %Етикети за заглавие и оси на генерираната фигура title('Симулация на ценови пътеки с процес на Леви в модела на Мертон ','FontSize',12) xlabel('Време t до падежа T, T=2') ylabel('30 ценови пътеки генерирани от S_{0}=35')    - 26 - PROCEEDINGS OF UNIVERSITY OF RUSE - 2018, volume 57, book 6.5.  Фиг. 2. Симулация на ценови пътеки в модела на Мертон  ИЗВОДИ  При генерирането на ценови пътеки в модела на Мертон трябва да бъдат симулирани два случайни процеса – един, който описва скоковете на цената на дадения актив (Поасонов) и дифузионен (Брауново лутане). Важно за симулацията на ценови пътеки в модела на Мертон е, че двата случайни процеса са независими един от друг [1].  Прилагането на метода Монте Карло не изисква задълбочени математически познания в областта на интегралното и диференциалното смятане за разлика от други количествени методи като квадратурния метод и схемите на крайни разлики. Структурата на метода Монте Карло изисква познания от линейната алгебра като умножение на числа с матрици, събиране и  умножение на матрици, поради това той лесно може да бъде внедрен чрез системата MATLAB (MatrixLaboratory) [1].    